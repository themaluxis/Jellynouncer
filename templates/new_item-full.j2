{#
  Jellynouncer New Item Full Discord Embed Template

  This template generates comprehensive Discord embed notifications for new media items added to Jellyfin.
  Provides detailed metadata, technical specifications, and rich information display.
  Enhanced version with extensive field coverage and professional presentation.

  Supports all media types with specialized formatting:
  - Episodes: Series branding, episode details, air dates
  - Movies: Rich metadata, cast, crew, technical specs
  - Music: Artist info, album details, audio quality
  - Photos: Dimensions, file info, metadata
  - Other: Generic handling with available metadata
#}
{
  "embeds": [
    {
      {#
        Dynamic Title Generation

        Creates context-appropriate titles with emojis based on the media type.
        Enhanced with specific titles for music content types.
      #}
      "title": "{% if item.item_type == 'Episode' -%}
        üì∫ New Episode Added
      {%- elif item.item_type == 'Series' -%}
        üì∫ New Series Added
      {%- elif item.item_type == 'Movie' -%}
        üé¨ New Movie Added
      {%- elif item.item_type == 'Season' -%}
        üì∫ New Season Added
      {%- elif item.item_type == 'Audio' -%}
        üéµ New Song Added
      {%- elif item.item_type == 'MusicAlbum' -%}
        üíø New Album Added
      {%- elif item.item_type == 'MusicArtist' -%}
        üé§ New Artist Added
      {%- elif item.item_type == 'Photo' -%}
        üì∑ New Photo Added
      {%- else -%}
        üìÅ New {{ item.item_type }} Added
      {%- endif %}",

      {#
        Rich Description with Plot Summaries

        Enhanced descriptions with comprehensive content information:
        - Episodes: Series name, season/episode numbers, episode title, air date
        - Music: Song/album name with artist information
        - Movies/Series: Title, year, tagline, plot summary
        - Photos: Name and dimensions
        - Includes overview/plot summary when available (truncated to 300 chars)
      #}
      "description": "{% if item.item_type == 'Episode' -%}
        **{{ item.series_name }}** S{{ '%02d'|format(item.season_number or 0) }}E{{ '%02d'|format(item.episode_number or 0) }}
        {{ item.name }}
        {%- if item.air_time %}\n*Originally aired: {{ item.air_time }}*{% endif -%}
      {%- elif item.item_type == 'Audio' -%}
        {% if item.album -%}
          **{{ item.album }}**
          {%- if item.album_artist %} by {{ item.album_artist }}{% endif -%}
        {% endif %}
        {{ item.name }}
        {%- if item.artists and item.artists|length > 0 %} by {{ item.artists|join(', ') }}{% endif -%}
      {%- elif item.item_type == 'MusicAlbum' -%}
        **{{ item.name }}**
        {%- if item.album_artist %} by {{ item.album_artist }}
        {%- elif item.artists and item.artists|length > 0 %} by {{ item.artists|join(', ') }}{% endif -%}
      {%- elif item.item_type == 'MusicArtist' -%}
        **{{ item.name }}**
      {%- elif item.item_type == 'Photo' -%}
        **{{ item.name }}**
        {%- if item.width and item.height %}\n{{ item.width }}√ó{{ item.height }} pixels{% endif -%}
      {%- else -%}
        **{{ item.name }}**
        {%- if item.year %} ({{ item.year }}){% endif -%}
        {%- if item.tagline %}\n*{{ item.tagline }}*{% endif -%}
      {%- endif -%}
      {%- if item.overview and item.overview|length > 0 %}\n\n{{ (item.overview[:300] + '...') if item.overview|length > 300 else item.overview }}{% endif %}",

      {#
        Color Coding

        Uses the color value passed from the application, with green as fallback.
      #}
      "color": {{ color }},

      {#
        Comprehensive Field System

        Advanced field organization with extensive metadata display.
        Prioritizes most important information first with logical grouping.
        Uses both inline and full-width fields for optimal visual layout.
      #}
      "fields": [
        {#
          Content Metadata Section (High Priority, Inline)

          Quick overview information displayed in compact format.
          Genres, rating, and studio information for immediate context.
        #}
        {% if item.genres and item.genres|length > 0 %}
        {
          "name": "üé≠ Genres",
          "value": "{{ item.genres[:5]|join(', ') }}{% if item.genres|length > 5 %} +{{ item.genres|length - 5 }} more{% endif %}",
          "inline": true
        },
        {% endif %}

        {% if item.official_rating %}
        {
          "name": "üõ°Ô∏è Content Rating",
          "value": "{{ item.official_rating }}",
          "inline": true
        },
        {% endif %}

        {% if item.studios and item.studios|length > 0 %}
        {
          "name": "üè¢ Studio",
          "value": "{{ item.studios[0] }}{% if item.studios|length > 1 %} +{{ item.studios|length - 1 }} more{% endif %}",
          "inline": true
        },
        {% endif %}

        {#
          Technical Specifications Section (Inline)

          Video and audio technical details for quality assessment.
          Enhanced audio specs for music content with bitrate and sample rate.
          Excludes video specs for music-only content.
        #}
        {% if item.video_height and item.item_type not in ['Audio', 'MusicAlbum', 'MusicArtist'] %}
        {
          "name": "üìê Quality",
          "value": "{{ item.video_height }}p{% if item.video_range and item.video_range != 'SDR' %} {{ item.video_range }}{% endif %}{% if item.video_width %} ({{ item.video_width }}√ó{{ item.video_height }}){% endif %}",
          "inline": true
        },
        {% endif %}

        {% if item.video_codec and item.item_type not in ['Audio', 'MusicAlbum', 'MusicArtist'] %}
        {
          "name": "üéûÔ∏è Video",
          "value": "{{ item.video_codec.upper() }}{% if item.video_profile %} {{ item.video_profile }}{% endif %}{% if item.video_framerate %} @ {{ item.video_framerate }}fps{% endif %}",
          "inline": true
        },
        {% endif %}

        {% if item.audio_codec %}
        {
          "name": "üîä Audio",
          "value": "{{ item.audio_codec.upper() }}{% if item.audio_channels %} {{ item.audio_channels }}.{% if item.audio_channels > 2 %}1{% else %}0{% endif %}{% endif %}{% if item.item_type in ['Audio', 'MusicAlbum', 'MusicArtist'] %}{% if item.audio_bitrate %} ‚Ä¢ {{ (item.audio_bitrate / 1000) | int }} kbps{% endif %}{% if item.audio_samplerate %} ‚Ä¢ {{ (item.audio_samplerate / 1000) | round(1) }} kHz{% endif %}{% endif %}",
          "inline": true
        },
        {% endif %}

        {#
          Content Information Section (Inline)

          Runtime, release dates, and other contextual information.
          Smart duration formatting for music vs video content.
        #}
        {% if item.runtime_ticks %}
        {
          "name": "‚è±Ô∏è {% if item.item_type in ['Audio', 'MusicAlbum', 'MusicArtist'] %}Duration{% else %}Runtime{% endif %}",
          "value": "{% if item.item_type in ['Audio', 'MusicAlbum', 'MusicArtist'] -%}
            {%- set total_seconds = (item.runtime_ticks / 10000000) | int -%}
            {%- set minutes = (total_seconds / 60) | int -%}
            {%- set seconds = total_seconds % 60 -%}
            {{ minutes }}:{{ '%02d' | format(seconds) }}
          {%- else -%}
            {%- set hours = (item.runtime_ticks / 36000000000) | int -%}
            {%- set minutes = ((item.runtime_ticks / 600000000) % 60) | int -%}
            {{ hours }}h {{ minutes }}m
          {%- endif %}",
          "inline": true
        },
        {% endif %}

        {% if item.premiere_date %}
        {
          "name": "üìÖ {% if item.item_type == 'Episode' %}Air Date{% else %}Release{% endif %}",
          "value": "{{ item.premiere_date[:10] }}",
          "inline": true
        },
        {% endif %}

        {% if item.year %}
        {
          "name": "üìÖ Year",
          "value": "{{ item.year }}",
          "inline": true
        },
        {% endif %}

        {#
          Detailed Audio Technical Information (Non-Inline)

          Comprehensive audio specifications for audio enthusiasts.
          Includes advanced technical details not shown in basic audio field.
        #}
        {% if item.item_type in ['Audio', 'MusicAlbum', 'MusicArtist'] and (item.audio_bitrate or item.audio_samplerate or item.audio_language or item.audio_title) %}
        {
          "name": "üîä Audio Technical Details",
          "value": "{% if item.audio_codec %}**Codec:** {{ item.audio_codec.upper() }}{% endif %}{% if item.audio_channels %}\n**Channels:** {{ item.audio_channels }}.{% if item.audio_channels > 2 %}1{% else %}0{% endif %}{% endif %}{% if item.audio_bitrate %}\n**Bitrate:** {{ '%.0f'|format(item.audio_bitrate / 1000) }} kbps{% endif %}{% if item.audio_samplerate %}\n**Sample Rate:** {{ item.audio_samplerate }}Hz{% endif %}{% if item.audio_language %}\n**Language:** {{ item.audio_language.upper() }}{% endif %}{% if item.audio_title %}\n**Stream Title:** {{ item.audio_title }}{% endif %}",
          "inline": false
        },
        {% endif %}

        {#
          Music-Specific Information Section (Non-Inline)

          Enhanced music metadata for albums and artists.
          Shows contributing artists and release information.
        #}
        {% if item.item_type in ['MusicAlbum', 'MusicArtist'] %}
        {
          "name": "üéµ {% if item.item_type == 'MusicAlbum' %}Album{% else %}Artist{% endif %} Information",
          "value": "{% if item.item_type == 'MusicAlbum' and item.artists and item.artists|length > 0 %}**Artists:** {{ item.artists|join(', ') }}{% endif %}{% if item.year %}\n**Year:** {{ item.year }}{% endif %}{% if item.album %}\n**Album:** {{ item.album }}{% endif %}",
          "inline": false
        },
        {% endif %}

        {#
          Photo-Specific Information Section (Non-Inline)

          Photo metadata including dimensions and file information.
        #}
        {% if item.item_type == 'Photo' and (item.width or item.height) %}
        {
          "name": "üì∑ Photo Information",
          "value": "{% if item.width and item.height %}**Dimensions:** {{ item.width }}√ó{{ item.height }}{% endif %}{% if item.file_size %}\n**File Size:** {{ '%.2f'|format(item.file_size / 1048576) }} MB{% endif %}",
          "inline": false
        },
        {% endif %}

        {#
          File and System Information Section (Inline)

          File size, library information, and system metadata.
          Provides technical context for media management.
        #}
        {% if item.file_size or item.library_name or item.date_created %}
        {
          "name": "üíæ File Information",
          "value": "{% if item.file_size %}**Size:** {{ '%.2f'|format(item.file_size / 1073741824) }} GB{% endif %}{% if item.library_name %}\n**Library:** {{ item.library_name }}{% endif %}{% if item.date_created %}\n**Added:** {{ item.date_created[:10] }}{% endif %}",
          "inline": true
        },
        {% endif %}

        {#
          External References Section (Inline)

          Links to external databases and information sources.
          Provides clickable links for additional information.
        #}
        {% if item.imdb_id or item.tmdb_id or item.tvdb_id %}
        {
          "name": "üîó External Links",
          "value": "{% if item.imdb_id %}**IMDb:** [{{ item.imdb_id }}](https://www.imdb.com/title/{{ item.imdb_id }}/){% endif %}{% if item.tmdb_id %}{% if item.imdb_id %}\n{% endif %}**TMDB:** [{{ item.tmdb_id }}](https://www.themoviedb.org/{% if item.item_type == 'Movie' %}movie{% else %}tv{% endif %}/{{ item.tmdb_id }}){% endif %}{% if item.tvdb_id %}{% if item.imdb_id or item.tmdb_id %}\n{% endif %}**TVDB:** [{{ item.tvdb_id }}](https://thetvdb.com/dereferrer/series/{{ item.tvdb_id }}){% endif %}",
          "inline": true
        },
        {% endif %}

        {#
          Server Information Section (Inline)

          Server and path information for system administrators.
          Useful for troubleshooting and file management.
        #}
        {% if item.server_name or item.file_path %}
        {
          "name": "üñ•Ô∏è Server Info",
          "value": "{% if item.server_name %}**Server:** {{ item.server_name }}{% endif %}{% if item.file_path %}\n**Path:** {{ item.file_path|truncate(50) }}{% endif %}",
          "inline": true
        }
        {% endif %}
      ],

      {#
        Main Image Display

        Uses the main image field for prominent poster/artwork display below description.
        Shows movie posters, album covers, series artwork, etc.
        Larger than thumbnail for better visual impact.

        Image Priority:
        - Movies: Movie poster
        - Music: Album/Artist artwork
        - Series: Series poster
        - Episodes: Episode or series artwork
        - Other: Primary artwork when available
      #}
      {% if has_thumbnail is defined and has_thumbnail and verified_thumbnail_url is defined and verified_thumbnail_url %},
      "image": {
        "url": "{{ verified_thumbnail_url }}"
      }{% endif %},

      {#
        Thumbnail for Logos Only

        Small thumbnail in top-right corner reserved for logos and branding.
        Shows series logos for episodes, studio logos, or other branding elements.

        Logo Priority:
        - Episodes: Series logo (if available)
        - Other content: Studio logo or branding (when implemented)
        - Fallback: No thumbnail if no logo available
      #}
      {% if item.item_type == 'Episode' and item.series_id is defined and item.series_id %},
      "thumbnail": {
        "url": "{{ jellyfin_url }}/Items/{{ item.series_id }}/Images/Logo?api_key={{ api_key }}&maxHeight=64&maxWidth=200"
      }{% endif %},

      {#
        Footer Information

        Enhanced footer with comprehensive attribution and metadata source info.
        Includes TheTVDB attribution when metadata is sourced from there.
      #}
      "footer": {
        "text": "Added to Jellyfin ‚Ä¢ {{ timestamp[:19] | replace('T', ' ') }} UTC{% if tvdb_attribution_needed is defined and tvdb_attribution_needed %}\nMetadata provided by TheTVDB{% endif %}",
        "icon_url": "{{ jellyfin_url }}/web/favicon.png"
      },

      {#
        Timestamp

        ISO timestamp for Discord's "time ago" formatting.
      #}
      "timestamp": "{{ timestamp }}"
    }
  ]
}