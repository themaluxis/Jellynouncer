{#
  ModÃ¨le Compact d'Ã‰lÃ©ment Mis Ã  Jour pour Jellynouncer
  ==========================================================

  Notification de mise Ã  jour minimale affichant uniquement les changements essentiels.
  Parfait pour les utilisateurs qui souhaitent des notifications de mise Ã  jour brÃ¨ves.

  Affiche : Titre, changement principal, nouvelle qualitÃ©
  Omet : MÃ©tadonnÃ©es dÃ©taillÃ©es, notes multiples, liste complÃ¨te des changements
#}
{
  "embeds": [
    {
      "title": {{ ("â¬†ï¸" ~ 
        ("ğŸ“º " ~ (item.name | default('Ã‰pisode Inconnu') | truncate(200, True, '...')) if item.item_type == 'Episode' else
         "ğŸ“º " ~ (item.name | default('SÃ©rie Inconnue') | truncate(200, True, '...')) if item.item_type == 'Series' else
         "ğŸ¬ " ~ (item.name | default('Film Inconnu') | truncate(200, True, '...')) if item.item_type == 'Movie' else
         "ğŸ“º " ~ (item.series_name | default('SÃ©rie Inconnue')) ~ " - Saison " ~ (item.season_number | default('?') | string) if item.item_type == 'Season' else
         "ğŸµ " ~ (item.name | default('Chanson Inconnue') | truncate(200, True, '...')) if item.item_type == 'Audio' else
         "ğŸ’¿ " ~ (item.name | default('Album Inconnu') | truncate(200, True, '...')) if item.item_type == 'MusicAlbum' else
         "ğŸ¤ " ~ (item.name | default('Artiste Inconnu') | truncate(200, True, '...')) if item.item_type == 'MusicArtist' else
         "ğŸ“· " ~ (item.name | default('Photo') | truncate(200, True, '...')) if item.item_type == 'Photo' else
         "ğŸ“ " ~ (item.name | default(item.item_type ~ ' Inconnu') | truncate(200, True, '...'))
        ) ~ " Mis Ã  Jour") | tojson }},

      {#
        Description SimplifiÃ©e
        -----------------------
        Juste le titre et les informations principales de mise Ã  jour
      #}
      "description": {{ (
        ("**" ~ item.series_name ~ "** - " ~ item.name) if item.item_type == 'Episode'
        else ("**" ~ item.name ~ "**" ~ (" (" ~ item.year ~ ")" if item.year else ""))
      ) | tojson }},

      "color": {{ color }},

      "fields": [
        {% set fields_added = namespace(count=0) %}

        {#
          Afficher uniquement la mise Ã  jour principale
        #}
        {% if changes and changes | length > 0 %}
          {% set primary_change = changes[0] %}
          {% set fields_added.count = fields_added.count + 1 %}
        {
          "name": "ğŸ”„ Mis Ã  Jour",
          "value": {{ ((primary_change.old_value or 'Inconnu') ~ " â†’ **" ~ (primary_change.new_value or 'Inconnu') ~ "**" ~
            (" (+" ~ ((changes | length - 1) | string) ~ " de plus)" if changes | length > 1 else "")
          ) | tojson }},
          "inline": true
        }
        {% endif %}

        {% if item.video_height %}
          {% if fields_added.count > 0 %},{% endif %}
        {
          "name": "ğŸ“ Nouvelle QualitÃ©",
          "value": {{ ((item.video_height | string) ~ "p" ~
            (" " ~ item.video_range if item.video_range and item.video_range != 'SDR' else "")
          ) | tojson }},
          "inline": true
        }
        {% endif %}
      ],

      "timestamp": {{ timestamp | tojson }}
    }
  ]
}